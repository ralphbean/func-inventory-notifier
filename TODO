rewrite this in pure python and release back to the func-inventory guy
